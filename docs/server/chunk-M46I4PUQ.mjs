import './polyfills.server.mjs';
import{$ as ue,ba as ge,ga as u,ja as fe,ka as x,la as ve,y as me,z as he}from"./chunk-VY6QQBVY.mjs";import{$a as $,Ba as f,Bd as y,Ea as v,Fd as pe,Ga as _,Ha as U,K as r,Ma as G,Nb as F,Ob as J,P as b,Pc as Z,Q as D,Ta as H,Ua as Q,Ub as h,Va as q,Vb as O,Wb as K,Xc as ee,Z as Y,Zb as X,_a as A,_b as S,ab as a,ad as te,ba as k,bb as p,cb as m,db as j,f as R,h as B,i as N,jb as w,kb as T,kd as oe,ld as C,mb as g,nb as c,nd as ie,od as re,pd as ne,q as W,qd as ae,rd as se,sa as s,sd as de,wb as M,xb as L,xd as ce,yc as E,yd as le,z}from"./chunk-DYVTYGJJ.mjs";import"./chunk-N7QBYMCK.mjs";var l=ae({source:"SearchPage",events:{searchYoutubeVideos:void 0,searchYoutubeVideosSuccess:void 0}});function _e(){return C({state:void 0},se((t,e=r(ne),o=r(pe))=>({searchYoutubeVideosInfo$:le(e,l.searchYoutubeVideos,i=>o.searchVideosInfo(i.payload.searchTerm,i.payload.page).pipe(z(n=>N([...n.map(d=>o.getVideoInfo(d.videoId).pipe(W(Ce=>(console.error(Ce),R({videoId:d.videoId,formatStreams:[]})))))])),B(n=>l.searchYoutubeVideosSuccess({searchTerm:i.payload.searchTerm,searchedVideosInfo:n.filter(d=>d!=null),page:i.payload.page}))),!1)})))}var xe={searchTerm:"",searchedVideosInfo:[],page:1},I=oe(ie(xe),_e(),Ie());function Ie(){return C({state:void 0},de(re(l.searchYoutubeVideosSuccess,({payload:{searchTerm:t,searchedVideosInfo:e,page:o}},i)=>({searchedVideosInfo:o===1?e:[...i.searchedVideosInfo,...e],page:o,searchTerm:t}))))}var be=()=>[E],Se=t=>({video:t}),De=(t,e)=>e.videoId;function we(t,e){if(t&1){let o=T();p(0,"div",6)(1,"ay-video-player-card",7),g("selected",function(n){b(o);let d=c();return D(d.onSelect(n))}),m()()}if(t&2){let o=e.video,i=c();s(),a("videoPlayerCardInfo",o)("showChannelNameFirst",!0)("horizontalThumbnailPlayerContainerMarginRight","16px")("playerPosition",i.PlayerPosition.Horizontal)("titleFontWeight","400")("titleFontSize","18px")("channelMarginTop","12px")("channelNameFontSize","12px")("videoStatisticFontSize","12px")("titleMarginBottom","0px")("playerBorderRadius","12px")("boxShadow","unset")("thumbnailSettingsButtonMarginTop","0px")("thumbnailDurationRightBottom","8px")("horizontalMaxWidth","500px")("horizontalMinWidth","240px")}}function Te(t,e){t&1&&w(0)}function Me(t,e){if(t&1&&_(0,Te,1,0,"ng-container",8),t&2){let o=c().$implicit;c();let i=M(5);a("ngTemplateOutlet",i)("ngTemplateOutletContext",F(2,Se,o))}}function Fe(t,e){t&1&&w(0)}function Oe(t,e){if(t&1&&_(0,Fe,1,0,"ng-container",8),t&2){let o=c().$implicit,i=c(),n=M(5);a("ngTemplateOutlet",n)("ngTemplateOutletContext",F(2,Se,i.Utilities.convertToPlayerSkeletonItem(o)))}}function Ee(t,e){t&1&&(U(0,Me,1,4)(1,Oe,1,4),H(2,0,be,null,1,null,null,1,G),q(),Q())}var P=class t extends y{maxWidth=S("1280px");videoCategories=S.required();videos=S.required();PlayerPosition=x;scrollDown=X();Utilities=u;displayedVideos=h(()=>this.videos().length>0?[...this.videos(),...u.createPlayerSkeletonItems(4)]:u.createPlayerSkeletonItems(20));router=r(te);onSelect(e){this.router.navigate(["watch"],{queryParams:{v:e}})}onScrollDown(){this.scrollDown.emit()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=k(t)))(i||t)}})();static \u0275cmp=f({type:t,selectors:[["ay-videos-search"]],hostVars:2,hostBindings:function(o,i){o&2&&L("--max-width",i.maxWidth())},inputs:{maxWidth:[1,"maxWidth"],videoCategories:[1,"videoCategories"],videos:[1,"videos"]},outputs:{scrollDown:"scrollDown"},features:[v],decls:8,vars:5,consts:[["videoCard",""],[1e3],[1,"videos_search_container"],[1,"videos_search_categories",3,"ayFixedTop"],[3,"videoCategories","scrollingWidth"],["ayInfiniteScroll","",1,"videos_search_player_grid",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle"],[1,"video-search"],[3,"selected","videoPlayerCardInfo","showChannelNameFirst","horizontalThumbnailPlayerContainerMarginRight","playerPosition","titleFontWeight","titleFontSize","channelMarginTop","channelNameFontSize","videoStatisticFontSize","titleMarginBottom","playerBorderRadius","boxShadow","thumbnailSettingsButtonMarginTop","thumbnailDurationRightBottom","horizontalMaxWidth","horizontalMinWidth"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(o,i){if(o&1){let n=T();p(0,"div",2)(1,"div",3),j(2,"ay-video-categories",4),m(),p(3,"div",5),g("scrolled",function(){return b(n),D(i.onScrollDown())}),_(4,we,2,16,"ng-template",null,0,J),A(6,Ee,4,0,null,null,De),m()()}o&2&&(s(),a("ayFixedTop",56),s(),a("videoCategories",i.videoCategories())("scrollingWidth",400),s(),a("infiniteScrollDistance",3)("infiniteScrollThrottle",50),s(3),$(i.displayedVideos()))},dependencies:[fe,ve,he,me,E],styles:["[_nghost-%COMP%]{position:relative;display:block}.videos_search_container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:24px}.videos_search_container[_ngcontent-%COMP%]   .videos_search_categories[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-right:16px;padding-top:12px;padding-bottom:12px}.videos_search_container[_ngcontent-%COMP%]   .videos_search_categories[_ngcontent-%COMP%]   ay-video-categories[_ngcontent-%COMP%]{width:0px;max-width:var(--max-width);flex-grow:1;padding-left:16px;padding-right:22px}.videos_search_container[_ngcontent-%COMP%]   .videos_search_player_grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;row-gap:16px;overflow:scroll;overflow-x:hidden}.videos_search_container[_ngcontent-%COMP%]   .videos_search_player_grid[_ngcontent-%COMP%]   .video-search[_ngcontent-%COMP%]{width:100%;max-width:var(--max-width);padding-left:16px;padding-right:16px}"],changeDetection:0})};var V=class t extends y{searchPageStore=r(I);videosCategoriesViewModel=h(()=>this.sandbox.sharedStore.videoCategories()?.items.map(o=>({title:o.snippet.title,id:o.id}))??[]);PlayerPosition=x;searchedVideosInfo=h(()=>this.searchPageStore.searchedVideosInfo().filter(e=>e.type==="video").map(e=>({isSkeleton:!1,videoId:e.videoId??"",title:e.title??"",channelName:e.author??"",viewCount:+(e.viewCount??0),publishedDate:u.epochToDate(e.published),lengthSeconds:e.lengthSeconds,channelLogoUrl:e.authorThumbnails[0]?.url??"",videoUrl:e.formatStreams[0]?.url??"",isVerified:e.authorVerified??!1}))??[]);route=r(ee);searchQuery=Y(null);searchYoutubeVideosInfo=h(()=>l.searchYoutubeVideos({searchTerm:this.searchQuery()??"",page:this.page()}));titleService=r(Z);sidebarService=r(ue);loadingBarService=r(ge);page=K(()=>(this.searchQuery(),1));constructor(){super(),this.dispatchEvent(ce.loadYoutubeVideoCategories()),this.dispatchEventFromSignal(this.searchYoutubeVideosInfo),O(()=>{this.titleService.setTitle(`${this.searchQuery()??""} - Angular Youtube`)}),O(()=>{this.searchedVideosInfo().length>0&&this.loadingBarService.load(100)})}ngOnInit(){this.route.queryParamMap.pipe(this.takeUntilDestroyed()).subscribe(e=>{this.searchQuery.set(e.get("search_query")),this.loadingBarService.load(25)}),this.sidebarService.setSelectedIconName(null)}onScrollDown(){this.page.update(e=>e+1)}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=f({type:t,selectors:[["ay-search"]],features:[v],decls:2,vars:2,consts:[[1,"search_container"],[3,"scrollDown","videos","videoCategories"]],template:function(o,i){o&1&&(p(0,"div",0)(1,"ay-videos-search",1),g("scrollDown",function(){return i.onScrollDown()}),m()()),o&2&&(s(),a("videos",i.searchedVideosInfo())("videoCategories",i.videosCategoriesViewModel()))},dependencies:[P],styles:["[_nghost-%COMP%]{position:relative;display:block}.search_container[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0})};var Pt=[{path:"",providers:[I],component:V,data:{detectRouteTransitions:!1}}];export{Pt as SEARCH_PAGE_ROUTES,V as SearchComponent};
